<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>IDV Assignment 2 – SVG Transforms (Interactive)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    /* ===== Base (pure white background required) ===== */
    html, body { background:#fff; margin:0; font-family:ui-sans-serif, system-ui, -apple-system, "Segoe UI", Arial, sans-serif; color:#0f172a; }
    * { box-sizing: border-box; }

    /* ===== Header ===== */
    .wrap { width:min(1180px,96vw); margin:0 auto; }
    header { padding:18px 0 10px; text-align:center; }
    h1 { font-size:22px; margin:0 0 6px; letter-spacing:.2px; }
    .sub { margin:0; color:#64748b; font-size:14px; }

    /* ===== Control Bar ===== */
    .controls {
      margin:14px auto 16px;
      display:grid; grid-template-columns: 1.2fr 1fr 1fr; gap:10px;
      align-items:center; font-size:14px;
    }
    @media (max-width: 760px){
      .controls { grid-template-columns:1fr; gap:8px; }
    }
    .card {
      background:#fff; border:1px solid #e5e7eb; border-radius:14px; padding:10px 12px;
      box-shadow: 0 2px 10px rgba(17,24,39,0.03);
    }
    .controls .row { display:flex; align-items:center; gap:10px; }
    .controls label strong { font-weight:600; }
    .controls input[type="range"] { width:100%; }
    .pill { padding:8px 12px; border:1px solid #e5e7eb; background:#fff; border-radius:999px; cursor:pointer; user-select:none; transition: transform .05s ease; }
    .pill:hover { background:#f9fafb; }
    .pill:active { transform: translateY(1px); }
    .pill[aria-pressed="true"] { background:#f3f4f6; }
    .end { justify-content:flex-end; }

    /* ===== Table ===== */
    table { width:min(1180px,96vw); margin:0 auto 26px; border-collapse:separate; border-spacing:0 10px; table-layout:fixed; }
    thead th {
      font-weight:700; font-size:13px; color:#334155;
      padding:10px 6px; border-bottom:2px solid #e2e8f0; background:#fff; position:sticky; top:0; z-index:2;
    }
    tbody td { padding:0 6px; text-align:center; }
    .cell {
      background:#fff; border:1px solid #e5e7eb; border-radius:14px;
      padding:10px; transition: box-shadow .18s ease, transform .18s ease, border-color .18s ease;
      box-shadow: 0 1px 6px rgba(2,6,23,0.04);
      cursor: zoom-in;
    }
    .cell:hover { box-shadow: 0 10px 26px rgba(2,6,23,0.08); transform: translateY(-2px); border-color:#dfe3ea; }

    /* SVG icons */
    .icon { width:110px; height:110px; display:block; margin-inline:auto; transition: transform 260ms ease, filter 160ms ease; }

    /* Tooltips via title attribute look fine. */

    /* ===== Column-specific behaviors ===== */

    /* Mirror column: mirrored by default via CSS (not inline), so the Flip button can toggle it cleanly */
    .mir-cell g[data-effect="mirror"]{
      transform: translate(50px,50px) scale(-1,1) translate(-50px,-50px);
      transition: transform 260ms ease;
    }
    /* When .flip-mirror is active on <body>, un-mirror the column */
    body.flip-mirror .mir-cell g[data-effect="mirror"]{
      transform: none;
    }

    /* Rotate column animation (optional, when toggled) */
    @keyframes spin180 {
      0%   { transform: rotate(0deg); }
      50%  { transform: rotate(180deg); }
      100% { transform: rotate(360deg); }
    }
    body.auto-rotate .rot-cell .icon { animation: spin180 2.4s linear infinite; }

    /* ===== Tip ===== */
    .tip { text-align:center; color:#64748b; font-size:12px; margin:4px 0 14px; }

    /* ===== Modal (Preview) ===== */
    dialog#viewer {
      width:min(760px,94vw); border:none; padding:0; border-radius:16px; overflow:hidden;
      box-shadow:0 16px 60px rgba(15,23,42,.25);
    }
    dialog::backdrop { background:rgba(0,0,0,.22); }
    .viewer-head {
      display:flex; align-items:center; justify-content:space-between;
      padding:12px 14px; border-bottom:1px solid #e5e7eb; background:#fff;
    }
    .viewer-body { display:grid; grid-template-columns:1fr 340px; }
    @media (max-width: 760px){ .viewer-body { grid-template-columns:1fr; } }
    .viewer-canvas {
      display:flex; align-items:center; justify-content:center; background:#fff; padding:20px; min-height:380px;
    }
    .viewer-controls { padding:14px; border-left:1px solid #e5e7eb; background:#fcfcfd; }
    @media (max-width: 760px){ .viewer-controls { border-left:none; border-top:1px solid #e5e7eb; } }
    .viewer-controls .row { margin:10px 0; display:flex; align-items:center; gap:10px; }
    .viewer-controls input[type="range"] { width:100%; }
    .btn { border:1px solid #e5e7eb; background:#fff; padding:8px 12px; border-radius:12px; cursor:pointer; }
    .btn:hover { background:#f8fafc; }
    .muted { color:#6b7280; font-size:12px; }

  </style>
</head>
<body>
  <header class="wrap">
    <h1>Assignment 2 – SVG Transform Gallery</h1>
    <p class="sub">Original • Mirrored (L–R) • Rotated 180° • Squeezed (vertical) • Grayscale</p>
  </header>

  <!-- Controls -->
  <section class="wrap controls">
    <div class="card">
      <div class="row" title="Adjust the squeeze strength applied to the 4th column only">
        <label><strong>Squeeze (Column 4)</strong></label>
        <input id="squeezeRange" type="range" min="10" max="100" value="50" />
        <span id="squeezeVal" aria-live="polite">50%</span>
      </div>
    </div>
    <div class="card">
      <div class="row">
        <button class="pill" id="btnMirror" aria-pressed="false" title="Toggle Mirror column (on = unflipped)">Flip Mirror</button>
        <button class="pill" id="btnRotate" aria-pressed="false" title="Animate Rotate column">Animate Rotate</button>
      </div>
    </div>
    <div class="card end">
      <div class="row">
        <button class="pill" id="btnReset" title="Reset all gallery controls">Reset</button>
      </div>
    </div>
  </section>

  <!-- Hidden sprite (10 asymmetric icons, all viewBox 0 0 100 100) -->
  <svg width="0" height="0" aria-hidden="true" focusable="false">
    <defs>
      <!-- Grayscale filter -->
      <filter id="gray"><feColorMatrix type="saturate" values="0"/></filter>

      <!-- 1) Leaf -->
      <symbol id="s-leaf" viewBox="0 0 100 100">
        <path d="M18,74 C35,40 52,28 84,18 C75,48 63,66 30,83 L18,74 Z"
              fill="#34A853" stroke="#1e7b3a" stroke-width="2"/>
        <path d="M22,72 C40,58 58,48 76,40" fill="none" stroke="#fff" stroke-width="2" opacity="0.7"/>
      </symbol>

      <!-- 2) Chat bubble (tail left) -->
      <symbol id="s-chat" viewBox="0 0 100 100">
        <path d="M18,25 h56 a8,8 0 0 1 8,8 v24 a8,8 0 0 1 -8,8 h-28 l-16,12 v-12 h-12 a8,8 0 0 1 -8,-8 v-24 a8,8 0 0 1 8,-8 z"
              fill="#4285F4" stroke="#1a61d8" stroke-width="2"/>
        <circle cx="36" cy="45" r="3" fill="#fff"/>
        <circle cx="50" cy="45" r="3" fill="#fff"/>
        <circle cx="64" cy="45" r="3" fill="#fff"/>
      </symbol>

      <!-- 3) Bent arrow -->
      <symbol id="s-bent" viewBox="0 0 100 100">
        <polyline points="20,25 20,60 65,60" fill="none" stroke="#EB4335" stroke-width="10" stroke-linecap="round" stroke-linejoin="round"/>
        <polygon points="62,45 88,60 62,75" fill="#EB4335"/>
      </symbol>

      <!-- 4) Heart (asymmetric highlight) -->
      <symbol id="s-heart" viewBox="0 0 100 100">
        <path d="M50,82 C36,68 18,57 18,38 C18,28 26,20 36,20 c7,0 11,3 14,7 c3,-6 9,-9 16,-9 c10,0 18,8 18,19 c0,19 -18,30 -34,45 z"
              fill="#EB4335" stroke="#b22a23" stroke-width="2"/>
        <path d="M40,30 q-6,2 -9,8" fill="none" stroke="#fff" stroke-width="3" opacity="0.7"/>
      </symbol>

      <!-- 5) Moon -->
      <symbol id="s-moon" viewBox="0 0 100 100">
        <!-- Crescent via subtractive mask for asymmetry -->
        <mask id="moon-cut">
          <rect x="0" y="0" width="100" height="100" fill="#fff"/>
          <circle cx="58" cy="42" r="28" fill="#000"/>
        </mask>
        <circle cx="44" cy="52" r="34" fill="#FBBC05" stroke="#d9a304" stroke-width="2" mask="url(#moon-cut)"/>
        <circle cx="54" cy="48" r="3" fill="#fff" opacity="0.85"/>
        <circle cx="49" cy="57" r="2" fill="#fff" opacity="0.6"/>
      </symbol>

      <!-- 6) Eighth note -->
      <symbol id="s-note" viewBox="0 0 100 100">
        <path d="M64,18 v44 a12,12 0 1 1 -6,-10 V26 l22,-6 v28 a12,12 0 1 1 -6,-10 V18 Z"
              fill="#4285F4" stroke="#1a61d8" stroke-width="2"/>
      </symbol>

      <!-- 7) Pin -->
      <symbol id="s-pin" viewBox="0 0 100 100">
        <path d="M50,86 C42,72 24,58 24,40 a26,26 0 1 1 52,0 c0,18 -18,32 -26,46 z"
              fill="#34A853" stroke="#1e7b3a" stroke-width="2"/>
        <circle cx="50" cy="40" r="9" fill="#fff"/>
        <path d="M43,33 a9,9 0 0 1 9,-5" fill="none" stroke="#fff" stroke-width="2" opacity="0.7"/>
      </symbol>

      <!-- 8) Wrench -->
      <symbol id="s-wrench" viewBox="0 0 100 100">
        <path d="M70,22 a18,18 0 0 0 -18,18 l8,8 l-28,28 a6,6 0 0 0 8,8 l28,-28 l8,8 a18,18 0 0 0 18,-18 l-12,4 l-16,-16 z"
              fill="#6b7280" stroke="#4b5563" stroke-width="2"/>
      </symbol>

      <!-- 9) Bolt -->
      <symbol id="s-bolt" viewBox="0 0 100 100">
        <polygon points="48,10 22,58 44,58 36,92 78,42 56,42 64,10"
                 fill="#FBBC05" stroke="#d9a304" stroke-width="2"/>
      </symbol>

      <!-- 10) Flask (asymmetric liquid) -->
      <symbol id="s-flask" viewBox="0 0 100 100">
        <path d="M38,14 h24 v10 l12,24 a6,6 0 0 1 -6,8 H32 a6,6 0 0 1 -6,-8 L38,24 z"
              fill="#9ca3af" stroke="#6b7280" stroke-width="2"/>
        <path d="M34,52 h36 v6 c0,6 -8,10 -18,10 s-18,-4 -18,-10 z" fill="#4285F4" opacity="0.85"/>
        <circle cx="50" cy="24" r="2" fill="#6b7280"/>
        <circle cx="58" cy="24" r="2" fill="#6b7280"/>
      </symbol>
    </defs>
  </svg>

  <div class="wrap tip">Tip: Click any cell to open a large preview with live controls.</div>

  <!-- Gallery -->
  <table aria-label="SVG transform gallery">
    <thead>
      <tr>
        <th>Original</th>
        <th>Mirrored (L–R)</th>
        <th>Rotated 180°</th>
        <th>Squeezed (V)</th>
        <th>Grayscale</th>
      </tr>
    </thead>
    <tbody id="tbody"></tbody>
  </table>

  <!-- Modal viewer -->
  <dialog id="viewer">
    <div class="viewer-head">
      <strong id="vTitle">Preview</strong>
      <button id="vClose" class="btn" aria-label="Close">✕</button>
    </div>
    <div class="viewer-body">
      <div class="viewer-canvas">
        <svg id="vSvg" class="icon" viewBox="0 0 100 100" width="360" height="360" aria-label="Preview icon">
          <!-- built dynamically -->
        </svg>
      </div>
      <div class="viewer-controls">
        <div class="row">
          <button id="vMirror" class="btn" aria-pressed="false" title="Toggle mirror">Mirror</button>
          <button id="vGray" class="btn" aria-pressed="false" title="Toggle grayscale">Grayscale</button>
        </div>
        <div class="row">
          <label style="width:100%">
            Rotation: <span id="vRotVal">0°</span>
            <input id="vRot" type="range" min="0" max="360" value="0" />
          </label>
        </div>
        <div class="row">
          <label style="width:100%">
            Squeeze (vertical): <span id="vSqVal">100%</span>
            <input id="vSq" type="range" min="10" max="100" value="100" />
          </label>
        </div>
        <div class="row">
          <button id="vReset" class="btn">Reset</button>
        </div>
        <p class="muted">All transforms are applied around the viewBox center (50,50). Export tip: take a screenshot on a white background.</p>
      </div>
    </div>
  </dialog>

  <script>
    const ids = ["s-leaf","s-chat","s-bent","s-heart","s-moon","s-note","s-pin","s-wrench","s-bolt","s-flask"];
    const EFFECTS = ["original","mirror","rotate","squeeze","grayscale"];
    const tbody = document.getElementById('tbody');

    /* ---------- Build cell ---------- */
    function cell(symId, effect) {
      const td  = document.createElement('td');
      td.className = ({
        mirror:"mir-cell",
        rotate:"rot-cell",
        squeeze:"sqz-cell",
      })[effect] || "";
      td.title = effect[0].toUpperCase()+effect.slice(1);

      const card = document.createElement('div');
      card.className = 'cell';

      const svg = document.createElementNS("http://www.w3.org/2000/svg","svg");
      svg.setAttribute("class","icon");
      svg.setAttribute("viewBox","0 0 100 100");

      if (effect === "grayscale") svg.style.filter = "url(#gray)";

      const g = document.createElementNS("http://www.w3.org/2000/svg","g");
      g.dataset.effect = effect;

      // IMPORTANT: no inline mirror transform here (CSS controls it).
      if (effect === "rotate")  g.setAttribute("transform","rotate(180 50 50)");
      if (effect === "squeeze") g.setAttribute("transform", squeezeTransform(0.50));

      const use = document.createElementNS("http://www.w3.org/2000/svg","use");
      use.setAttribute("href", `#${symId}`);
      use.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href", `#${symId}`);

      g.appendChild(use);
      svg.appendChild(g);
      card.appendChild(svg);
      td.appendChild(card);

      td.dataset.sym = symId;
      td.dataset.effect = effect;
      td.addEventListener('click', openViewer);

      return td;
    }

    /* ---------- Build table ---------- */
    ids.forEach(id => {
      const tr = document.createElement('tr');
      EFFECTS.forEach(eff => tr.appendChild(cell(id, eff)));
      tbody.appendChild(tr);
    });

    /* ---------- Controls (gallery-wide) ---------- */
    const squeezeRange = document.getElementById('squeezeRange');
    const squeezeVal = document.getElementById('squeezeVal');
    const btnMirror = document.getElementById('btnMirror');
    const btnRotate = document.getElementById('btnRotate');
    const btnReset  = document.getElementById('btnReset');

    function squeezeTransform(f){ // f in [0.1..1]; center-preserving
      const ty = (1 - f) * 50;    // move down before scaling
      return `translate(0,${ty}) scale(1,${f})`;
    }

    function updateSqueezeColumn() {
      const f = Number(squeezeRange.value)/100;
      document.querySelectorAll('td.sqz-cell g[data-effect="squeeze"]').forEach(g=>{
        g.setAttribute('transform', squeezeTransform(f));
      });
      squeezeVal.textContent = `${Math.round(f*100)}%`;
    }
    squeezeRange.addEventListener('input', updateSqueezeColumn);

    btnMirror.addEventListener('click', () => {
      const on = btnMirror.getAttribute('aria-pressed') === 'true';
      btnMirror.setAttribute('aria-pressed', String(!on));
      document.body.classList.toggle('flip-mirror', !on); // when true: un-mirror
    });

    btnRotate.addEventListener('click', () => {
      const on = btnRotate.getAttribute('aria-pressed') === 'true';
      btnRotate.setAttribute('aria-pressed', String(!on));
      document.body.classList.toggle('auto-rotate', !on);
    });

    btnReset.addEventListener('click', () => {
      squeezeRange.value = 50; updateSqueezeColumn();
      btnMirror.setAttribute('aria-pressed','false');
      btnRotate.setAttribute('aria-pressed','false');
      document.body.classList.remove('flip-mirror','auto-rotate');
    });

    // Initialize
    updateSqueezeColumn();

    /* ---------- Modal Viewer ---------- */
    const viewer = document.getElementById('viewer');
    const vClose = document.getElementById('vClose');
    const vSvg   = document.getElementById('vSvg');
    const vTitle = document.getElementById('vTitle');

    const vMirror = document.getElementById('vMirror');
    const vGray   = document.getElementById('vGray');
    const vRot    = document.getElementById('vRot');
    const vRotVal = document.getElementById('vRotVal');
    const vSq     = document.getElementById('vSq');
    const vSqVal  = document.getElementById('vSqVal');
    const vReset  = document.getElementById('vReset');

    let currentSym = null;

    function openViewer(e){
      const td = e.currentTarget;
      currentSym = td.dataset.sym;
      const effect = td.dataset.effect;

      // Clear & rebuild preview SVG groups
      while (vSvg.firstChild) vSvg.removeChild(vSvg.firstChild);
      const outer = document.createElementNS("http://www.w3.org/2000/svg","g"); // mirror/rotate around center
      outer.setAttribute('data-role','outer');
      const inner = document.createElementNS("http://www.w3.org/2000/svg","g"); // vertical squeeze
      inner.setAttribute('data-role','inner');

      const use = document.createElementNS("http://www.w3.org/2000/svg","use");
      use.setAttribute('href', `#${currentSym}`);
      use.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href", `#${currentSym}`);

      inner.appendChild(use);
      outer.appendChild(inner);
      vSvg.appendChild(outer);

      // Reset control states based on clicked effect
      vMirror.setAttribute('aria-pressed','false');
      vGray.setAttribute('aria-pressed', effect === 'grayscale' ? 'true' : 'false');
      vRot.value = (effect === 'rotate') ? 180 : 0;
      vSq.value  = (effect === 'squeeze') ? 50 : 100;
      vRotVal.textContent = `${vRot.value}°`;
      vSqVal.textContent  = `${vSq.value}%`;

      applyViewerTransforms();

      vTitle.textContent = `Preview: ${currentSym.replace('s-','')}`;
      vSvg.style.filter = (effect === 'grayscale') ? 'url(#gray)' : 'none';

      viewer.showModal();
    }

    function applyViewerTransforms(){
      const outer = vSvg.querySelector('g[data-role="outer"]');
      const inner = vSvg.querySelector('g[data-role="inner"]');

      const mirrored = vMirror.getAttribute('aria-pressed') === 'true';
      const deg = Number(vRot.value);
      const f   = Number(vSq.value)/100;
      vRotVal.textContent = `${deg}°`;
      vSqVal.textContent  = `${Math.round(f*100)}%`;

      // Outer transform (centered)
      let outerTf = `translate(50,50)`;
      if (mirrored) outerTf += ` scale(-1,1)`;
      if (deg !== 0) outerTf += ` rotate(${deg})`;
      outerTf += ` translate(-50,-50)`;
      outer.setAttribute('transform', outerTf);

      // Inner squeeze
      inner.setAttribute('transform', squeezeTransform(f));
    }

    vMirror.addEventListener('click', ()=>{
      const on = vMirror.getAttribute('aria-pressed') === 'true';
      vMirror.setAttribute('aria-pressed', String(!on));
      applyViewerTransforms();
    });
    vGray.addEventListener('click', ()=>{
      const on = vGray.getAttribute('aria-pressed') === 'true';
      vGray.setAttribute('aria-pressed', String(!on));
      vSvg.style.filter = on ? 'none' : 'url(#gray)';
    });
    vRot.addEventListener('input', applyViewerTransforms);
    vSq.addEventListener('input', applyViewerTransforms);

    vReset.addEventListener('click', ()=>{
      vMirror.setAttribute('aria-pressed','false');
      vGray.setAttribute('aria-pressed','false');
      vRot.value = 0; vSq.value = 100;
      vSvg.style.filter = 'none';
      applyViewerTransforms();
    });

    vClose.addEventListener('click', ()=> viewer.close());
    viewer.addEventListener('click', (e)=>{ // click outside to close
      const rect = viewer.getBoundingClientRect();
      const inside = (e.clientX >= rect.left && e.clientX <= rect.right &&
                      e.clientY >= rect.top  && e.clientY <= rect.bottom);
      if (!inside) viewer.close();
    });
    window.addEventListener('keydown', (e)=>{ if (e.key === 'Escape' && viewer.open) viewer.close(); });
  </script>
</body>
</html>
